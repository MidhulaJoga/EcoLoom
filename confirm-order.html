<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Confirm Order - Ecoloom</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-6">

  <div class="max-w-xl mx-auto bg-white p-6 rounded shadow">
    <h2 class="text-2xl font-bold text-green-700 mb-4">ðŸ§¾ Confirm Your Order</h2>
    <p class="mb-2"><strong>Payment Method:</strong> Cash on Delivery</p>

    <label class="block mt-4 mb-2 font-medium">Delivery Address:</label>
    <textarea id="address" rows="4" class="w-full p-2 border rounded" placeholder="Enter your address here..."></textarea>

    <button onclick="placeOrder()" class="mt-4 w-full bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">Confirm Order</button>
  </div>

  <script>
    function placeOrder() {
      const address = document.getElementById("address").value.trim();
      if (!address) {
        alert("Please enter your address.");
        return;
      }

      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      const currentUser = JSON.parse(localStorage.getItem('currentUser'));
      const notifications = JSON.parse(localStorage.getItem("notifications")) || [];
      const orders = JSON.parse(localStorage.getItem("orders")) || [];

      cart.forEach(item => {
        // Send notification to seller
        notifications.push({
          to: item.user,
          message: `${currentUser.name} bought your item: ${item.name}`
        });

        // Save order for buyer
        orders.push({
          ...item,
          buyerEmail: currentUser.email,
          buyerName: currentUser.name,
          address: address
        });
      });

      localStorage.setItem("notifications", JSON.stringify(notifications));
      localStorage.setItem("orders", JSON.stringify(orders));
      localStorage.removeItem("cart");

      alert("ðŸŽ‰ Order confirmed! Delivery will be made to your address.");
      window.location.href = "profile.html";
    }
  </script>

</body>
</html>
