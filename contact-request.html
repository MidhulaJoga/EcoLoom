<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Contact Request</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white p-6 min-h-screen flex items-center justify-center">
  <div class="bg-gray-100 p-6 rounded shadow max-w-md w-full text-center">
    <h2 class="text-xl font-bold mb-4 text-green-700">ðŸ“© Contact Request</h2>
    <p id="message" class="mb-2 text-gray-800 font-medium">Waiting for user info...</p>
    <p id="user-info" class="text-sm text-gray-600 mb-6"></p>

    <div class="flex justify-center gap-4">
      <button onclick="respond('accepted')" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">Accept</button>
      <button onclick="respond('declined')" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">Decline</button>
    </div>
  </div>

  <script>
    const messageEl = document.getElementById("message");
    const userInfoEl = document.getElementById("user-info");

    // Load from localStorage if already set
    const request = JSON.parse(localStorage.getItem("contactRequest"));
    if (request?.name && request?.email) {
      messageEl.textContent = `${request.name} wants to contact you.`;
      userInfoEl.textContent = `Email: ${request.email}`;
    }

    // Fallback: receive user info via postMessage
    window.addEventListener("message", (event) => {
      const { name, email } = event.data;
      messageEl.textContent = `${name} wants to contact you.`;
      userInfoEl.textContent = `Email: ${email}`;
    });

    function respond(response) {
      // Send response back to opener (customize page)
      if (window.opener) {
        window.opener.postMessage({ contactResult: response }, "*");
      }
      window.close();
    }
  </script>
</body>
</html>
